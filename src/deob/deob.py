from psqloperation import PsqlCon
import chromeDeob
import jsbeautify
import rmcomment
import chunkJS
import malurl
import utils


def deobLink(url, jscommentname, jsname, chunkoutdir, beautifydir):
	chromeDeob.chromeDeobLink(url, jscommentname)
	rmcomment.rmCommentFile(jscommentname, jsname)
	chunkJS.chunkJSFile(jsname, chunkoutdir)
	jsbeautify.jsdeobfuscatedir(chunkoutdir, beautifydir)


def deobFile():
	return


def deobLabel(label):
	con = PsqlCon()
	res = con.psqlSelectOneLabel('TEST')
	for url, url_hash, label in res:
		paras = utils.genTempFilename(url, url_hash, label)
		deobLink(paras[0], paras[1], paras[2], paras[3], paras[4])


def deobTerry():
	jsbeautify.deobJSTerry()


if __name__=='__main__':
	con = PsqlCon()
	print con.psqlSelectOneLabel('TEST')
	deobLabel('TEST')
	
	# Store the related information into 
	# con.psqlReadURLHashFromFile('../../data/TempData/URLs/alexaustop')

