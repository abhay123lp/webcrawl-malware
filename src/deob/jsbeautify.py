import jsbeautifier
import commands
import time

def jsdeobfuscate(inputdir, outputdir):
	infiles = commands.getoutput('ls ' + inputdir)
	infiles = infiles.split('\n')
	for infile in infiles:
		res = jsbeautifier.beautify_file(inputdir + infile)
		# outfile = outputdir + '/' + infile.split('/')[-1]
		outfile = outputdir + '/' + infile
		open(outfile, 'w').write(res)
		

def deobJSTerry():
	inputdir = '../../data/JSTerry/javascript_20131018/'
	outputdir = '../../data/JSTerry/deobjs/'
	jsdeobfuscate(inputdir, outputdir)


def main():
	inputdir = '../../data/TempData/JSFiles/'
	outputdir = '../../data/TempData/BeautifiedJS/'
	while True:
		jsdeobfuscate(inputdir, outputdir)
		print 'Sleeping'
		time.sleep(60 * 60 * 24)


if __name__=="__main__":
	deobJSTerry()
