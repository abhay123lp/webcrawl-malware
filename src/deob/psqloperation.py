import psycopg2
import commands
import pprint
import sys

class PsqlCon:
	def __init__(self, username='postgres', dbname='pdmb', tbname='hash_url'):
		self.username = username
		self.dbname = dbname
		self.tbname = tbname
		self.con = None
		self.connectdb()

	def connectdb(self):
		self.con = psycopg2.connect(database=self.dbname, user=self.username)
		self.cur = self.con.cursor()
		self.cur.execute('SELECT version()')
		ver = self.cur.fetchone()
		print ver
		
	def psqlTest(self):
		self.cur.execute("SELECT count(*) from hash_url")
		records = self.cur.fetchall()
		for record in records:
			print record

	def psqlInsertFromFile(self, filename):
		return


if __name__=="__main__":
	con = PsqlCon()
	con.psqlTest()
