import commands
import utils
import os

def zipfile(indir, outfile):
	cmdzip = 'gzip -r -c ' + indir + ' > ' + outfile
	commands.getoutput(cmdzip)
	return os.path.getsize(outfile)


def zipdir(indir, grep, outdir):
	results = utils.lsgrep(indir, grep)
	emptyfile = open(outdir + '/' + 'emptyfile', 'w')
	for result in results:
		size = zipfile(indir + '/' + result, outdir + '/' + result)
		if size == 0:
			emptyfile.write(result + '\n')


def uploadB1(number):
	infile = '../../data/TempData/URLs/alexaustop'
	uploaddir = '../../data/JSAdd2Tree/'
	inf = open(infile, 'r')
	count = 0
	for line in inf:
		if count >= number:
			break
		else:
			count = count + 1
		uploadfile = 'B1.' + line.split(',')[0][2:-1]
		cmdupload = 'scp -r ' + uploaddir + uploadfile + ' urlcrawl:/space/webcrawl-malware/data/JSAdd2Tree/'
		commands.getoutput(cmdupload)


if __name__=="__main__":
	zipdir('../../data/JSAdd2Tree/', 'MTerry', '../../data/JSZipped')
	# uploadB1(50)
