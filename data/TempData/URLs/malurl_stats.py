import commands
import operator

def main():
	regex = 'malurl-2013*'
	files = commands.getoutput('ls {0}'.format(regex)).split('\n')

	outf = open('malurl.stats', 'w')
	label2count = dict()
	for fname in files:
		print fname
		inf = open(fname, 'r')
		for line in inf:
			if line == '' or line == '\n':
				continue
			line = line.split('\',\'')[4]
			if line in label2count:
				label2count[line] = label2count[line] + 1
			else:
				label2count[line] = 1


	# for key, value in sorted(label2count.items()):
	for key, value in sorted(label2count.iteritems(), key=operator.itemgetter(1)):
		outf.write(str(key) + ',' + str(value) + '\n')

	outf.close()
			


if __name__=="__main__":
        main()
